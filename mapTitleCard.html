<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Upper Arlington Title Card â€“ Dark</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link href="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

  <script src="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
  <script src="https://unpkg.com/@turf/turf@^7/turf.min.js"></script>

  <style>
    html,body,#container,#map{margin:0;padding:0;height:100%;width:100%;}

    /* â€•â€•â€• Popup dark shell â€•â€•â€• */
    .mapboxgl-popup{
      font:12px/20px 'Roboto',sans-serif;
      background:#1c1f24;        /* ðŸ“Œ CHANGED */
      color:#fff;                /* ðŸ†• force white text */
      box-shadow:0 0 10px rgba(0,0,0,.4); /* stronger shadow on dark */
      width:175px;
      z-index:9999;
      padding:0;margin:0;
    }
    .mapboxgl-popup .mapboxgl-popup-tip{display:none;}
    .mapboxgl-popup-close-button{
      top:2px;right:4px;width:10px;height:10px;
      color:#fff;                /* ðŸ“Œ CHANGED */
    }
    .mapboxgl-popup-header{margin:0;font-size:16px;font-weight:700;padding:5px;}
    .mapboxgl-popup-content{
      font-size:12px;line-height:1.25;
      background:#272b31;        /* ðŸ“Œ CHANGED */
      color:#d0d4db;             /* light-grey body text */
      padding:8px;margin-left:0;
    }
  </style>
</head>

<body>
  <div id="container"><div id="map"></div></div>

  <script>
    /* â€•â€• constants â€•â€• */
    const INITIAL_LOC  = [-83.22, 40.04];
    const INITIAL_ZOOM = 10.9;
    const communityScaleGray = "#9aa4b1"; /* lighter stroke for dark bg  ðŸ“Œ CHANGED */
    const placeOfInterest = "Upper Arlington";

    mapboxgl.accessToken =
      'pk.eyJ1IjoiZW10em90MDEiLCJhIjoiY20zZ2kyd3RpMDRnajJscHoyMG5neGJldyJ9.poXi4pgd2CoXKV2B4kg1Cw';

    const map = new mapboxgl.Map({
      container:'map',
      style:'mapbox://styles/mapbox/dark-v11',    /* ðŸ“Œ CHANGED to Mapbox Dark */
      center: INITIAL_LOC,
      zoom: INITIAL_ZOOM
    });

    map.on('load', () => {

      /* â€”â€” GeoJSON source â€”â€” */
      map.addSource('ohioPlaces',{
        type:'geojson',
        data:'https://raw.githubusercontent.com/emtzot/mapSources/main/ohioPlacesCensus2020.geojson',
        promoteId:'GEOID'
      });

      /* â€”â€” base fill layer â€”â€” */
      map.addLayer({
        id:'places-layer',
        type:'fill',
        source:'ohioPlaces',
        paint:{
          'fill-color':'#38424d',          /* ðŸ†• muted slate */
          'fill-opacity':[
            'case',['boolean',['feature-state','hover'],false],0.7,0.25]
        }
      },'settlement-major-label');

      /* â€”â€” outlines â€”â€” */
      map.addLayer({
        id:'places-boundaries',
        type:'line',
        source:'ohioPlaces',
        paint:{
          'line-color':communityScaleGray,
          'line-width':1.2,
          'line-opacity':0.6             /* ðŸ“Œ dark-friendly */
        }
      },'settlement-major-label');

      /* â€”â€” highlight UA â€”â€” */
      map.addLayer({
        id:'placeOfInterest-layer',
        type:'fill',
        source:'ohioPlaces',
        filter:['==','NAME',placeOfInterest],
        paint:{
          'fill-color':communityScaleGray,
          'fill-opacity':0.5
        }
      },'settlement-major-label');
    });

    /* â€”â€” hover state â€”â€” */
    let hoveredPlaceId=null;
    map.on('mousemove','places-layer',e=>{
      if(e.features.length){
        if(hoveredPlaceId!==null){
          map.setFeatureState({source:'ohioPlaces',id:hoveredPlaceId},{hover:false});
        }
        hoveredPlaceId=e.features[0].id;
        map.setFeatureState({source:'ohioPlaces',id:hoveredPlaceId},{hover:true});
      }
    });
    map.on('mouseleave','places-layer',()=>{
      if(hoveredPlaceId!==null){
        map.setFeatureState({source:'ohioPlaces',id:hoveredPlaceId},{hover:false});
      }
      hoveredPlaceId=null;
    });

    /* â€”â€” click popup â€”â€” */
    map.on('click',e=>{
      const [selected]=map.queryRenderedFeatures(e.point,{layers:['places-layer']});
      if(selected){
        new mapboxgl.Popup({closeButton:true})
          .setLngLat(selected.geometry.coordinates[0][0])
          .setHTML(`
            <div class="mapboxgl-popup-header">${selected.properties.NAME}</div>
          `)
          .addTo(map);
      }
    });
  </script>
</body>
</html>
